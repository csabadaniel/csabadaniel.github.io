<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Milliomos</title>
    <style>
      #background {
        position: absolute;
        top: 400px;
        left: 0px;
      }
      #question {
        position: absolute;
        top: 426px;
        left: 70px;
        color: orange;
        font-size: 30px;
      }
      .answer {
        color: orange;
        font-size: 20px;
        cursor: pointer;
      }
      #button1 {
        position: absolute;
        top: 502px;
        left: 70px;
      }
      #button2 {
        position: absolute;
        top: 548px;
        left: 70px;
      }
      #button3 {
        position: absolute;
        top: 502px;
        left: 433px;
      }
      #button4 {
        position: absolute;
        top: 548px;
        left: 433px;
      }
      #video {
        position: absolute;
        top: 0px;
        left: 0px;
        height: 400px;
      }
      #moneyTree {
        position: absolute;
        top: 0px;
        left: 533px;
        width: 267px;
        height: 400px;
        background-color: black;
        color: orange;
        font-size: 30px;
      }
    </style>
  </head>
  <body>
    <audio id="audio" src="1001000%20music.mp3" autoplay loop></audio>
    <video id="video" autoplay></video>
    <img id="background" src="millionaire_background.png"/>
    <div id="question">Question?</div>
    <div id="button1" class="answer">Answer 1</div>
    <div id="button2" class="answer">Answer 2</div>
    <div id="button3" class="answer">Answer 3</div>
    <div id="button4" class="answer">Answer 4</div>
    <div id="moneyTree">
      <div id="money8">8. 800000Ft</div>
      <div id="money7">7. 500000Ft</div>
      <div id="money6">6. 300000Ft</div>
      <div id="money5">5. 200000Ft</div>
      <div id="money4">4. 100000Ft</div>
      <div id="money3">3. 50000Ft</div>
      <div id="money2">2. 25000Ft</div>
      <div id="money1">1. 10000Ft</div>
    </div>
    <script>
      var rounds = [
        {
          "question": "Mi a sejt?",
          "answers": [
            "A legkisebb élő elemi egység",
            "A legkisebb élő elemi hegység",
            "Testrész",
            "Nem tudom"
          ],
          "correct": 0
        },
        {
          "question": "Mi a legtisztább hely Magyarországon?",
          "answers": [
            "Az MTA részecskekutató laboratóriuma",
            "A Máv kórház fertőtlenítője",
            "A Daubner cukrászda kemencéje",
            "A Tarci Klári konyhája"
          ],
          "correct": 3
        },
        {
          "question": "Hány méter magas a Vönöcki hegy?",
          "answers": [
            "500 méter",
            "5 méter",
            "2000 méter",
            "3000 méter"
          ],
          "correct": 1
        },
        {
          "question": "Kepler első törvénye úgy kezdődik, hogy...",
          "answers": [
            "A bolygók pályája...",
            "A föld pályája...",
            "A nap pályája...",
            "A hold pályája..."
          ],
          "correct": 0
        },
        {
          "question": "Ki írt levelet Anyeginnek?",
          "answers": [
            "Szvetlana",
            "Olga",
            "Tatjana",
            "Borisz"
          ],
          "correct": 2
        },
        {
          "question": "Товарищ учительница...",
          "answers": [
            "Я Докладываю Вам",
            "Я играю",
            "Ну погоди",
            "Зеленая крокодила"
          ],
          "correct": 0
        },
        {
          "question": "Mikor kell elkezdeni a gyerek nevelését?",
          "answers": [
            "Születésekor",
            "10 évesen",
            "1 évesen",
            "18 évvel születése előtt"
          ],
          "correct": 3
        },
        {
          "question": "Mit mondott Lenin?",
          "answers": [
            "Ma esni fog",
            "деньги деньги деньги",
            "Lernen, lernen, lernen",
            "Boldog Karácsonyt!"
          ],
          "correct": 2
        }
      ];

      var video = document.querySelector('video');
      var audio = document.querySelector('audio');
      var question = document.querySelector('div#question');
      var button1 = document.querySelector('div#button1');
      var button2 = document.querySelector('div#button2');
      var button3 = document.querySelector('div#button3');
      var button4 = document.querySelector('div#button4');
      var buttons = [button1, button2, button3, button4];
      var money1 = document.querySelector('div#money1');
      var money2 = document.querySelector('div#money2');
      var money3 = document.querySelector('div#money3');
      var money4 = document.querySelector('div#money4');
      var money5 = document.querySelector('div#money5');
      var money6 = document.querySelector('div#money6');
      var money7 = document.querySelector('div#money7');
      var money8 = document.querySelector('div#money8');
      var moneyTree = [money1, money2, money3, money4, money5, money6, money7, money8];

      if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
        // Not adding `{ audio: true }` since we only want video now
        navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
          //video.src = window.URL.createObjectURL(stream);
          video.srcObject = stream;
          video.play();
        });
        navigator.mediaDevices.getUserMedia({audio: true}).then(function(){
          audio.play();
        });
      }

      var roundIndex = 0;

      function displayRound() {
        var round = rounds[roundIndex];
        question.innerHTML = round.question;
        round.answers.forEach(
          function (answer, answerIndex) {
            var button = buttons[answerIndex];
            button.innerHTML = answer;
            if (round.correct == answerIndex) {
              if (rounds.length > roundIndex + 1) {
                button.onclick = function () { roundIndex++; displayRound(); }
              } else {
                button.onclick = function () { finishGame(true); }
              }
            } else {
              button.onclick = function () { finishGame(false); }
            }
          }
        );
        moneyTree[roundIndex].style.backgroundColor = 'orange';
        moneyTree[roundIndex].style.color = 'black';
        if (roundIndex > 0) {
          moneyTree[roundIndex - 1].style.backgroundColor = 'black';
          moneyTree[roundIndex - 1].style.color = 'orange';
        }
      }

      function finishGame(won) {
        buttons.forEach(
          function(button) {
            button.onclick = null;
            button.style.cursor = 'text';
          }
        );
        if (won) {
          audio.loop = false;
          audio.src = 'correct%20answer.mp3';
        } else {
          audio.loop = false;
          audio.src = 'wrong%20answer.mp3';
          window.setInterval(
              function() {
                var style = buttons[rounds[roundIndex].correct].style;
                if (style.color == 'orange') {
                  style.color = 'black';
                  style.backgroundColor = 'orange';
                } else {
                  style.color = 'orange';
                  style.backgroundColor = 'black';
                }
              },
              250
          );
        }
        audio.load();
      }

      document.body.onload = function() {
        displayRound();
      }
    </script>
  </body>
</html>